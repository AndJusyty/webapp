
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/luxon/build/global/luxon.min.js"></script>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(to bottom, #f3f4f6, #e5e7eb);
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
      color: #111827;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    .container {
      max-width: 480px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    label {
      font-weight: 500;
      margin-top: 10px;
      display: block;
    }

    input, select, button {
      font-size: 16px;
      padding: 12px;
      margin-top: 8px;
      width: 100%;
      box-sizing: border-box;
      border: 1px solid #d1d5db;
      border-radius: 12px;
      outline: none;
    }

    button {
      background: linear-gradient(to right, #3b82f6, #2563eb);
      color: white;
      font-weight: bold;
      border: none;
      margin-top: 20px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background: linear-gradient(to right, #2563eb, #1d4ed8);
    }

    #result {
      margin-top: 20px;
      font-size: 15px;
      padding: 12px;
      background: #f9fafb;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üìÖ –£–¥–æ–±–Ω—ã–π –≤—ã–±–æ—Ä –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏</h2>

    <label for="date">–î–∞—Ç–∞</label>
    <input type="text" id="date" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É">

    <label for="time">–í—Ä–µ–º—è</label>
    <input type="text" id="time" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è">

    <label for="timezone">–¢–∞–π–º–∑–æ–Ω–∞</label>
    <select id="timezone">
      <option value="UTC">UTC</option>
      <option value="Europe/Moscow" selected>Europe/Moscow</option>
      <option value="Asia/Yekaterinburg">Asia/Yekaterinburg</option>
      <option value="Europe/London">Europe/London</option>
      <option value="Asia/Tokyo">Asia/Tokyo</option>
      <option value="America/New_York">America/New_York</option>
    </select>

    <button id="submitBtn">‚úÖ –ì–æ—Ç–æ–≤–æ</button>

    <div id="result">‚åõ –û–∂–∏–¥–∞–µ–º –≤–≤–æ–¥...</div>
  </div>

  <script>
    const { DateTime } = luxon;
    let selectedDate = null;
    let selectedTime = null;

    flatpickr("#date", {
      dateFormat: "Y-m-d",
      onChange: (dates) => selectedDate = dates[0]
    });

    flatpickr("#time", {
      enableTime: true,
      noCalendar: true,
      dateFormat: "H:i",
      time_24hr: true,
      onChange: (times) => selectedTime = times[0]
    });

    document.getElementById("submitBtn").addEventListener("click", () => {
      const zone = document.getElementById("timezone").value;
      if (!selectedDate || !selectedTime) {
        document.getElementById("result").textContent = "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è!";
        return;
      }

      const merged = new Date(
        selectedDate.getFullYear(),
        selectedDate.getMonth(),
        selectedDate.getDate(),
        selectedTime.getHours(),
        selectedTime.getMinutes()
      );

      const local = DateTime.fromJSDate(merged).setZone(zone);
      const utc = local.toUTC();

      const resultText = `
üìç –õ–æ–∫–∞–ª—å–Ω–æ–µ: ${local.toFormat("yyyy-MM-dd HH:mm ZZZZ")}
üåê UTC: ${utc.toFormat("yyyy-MM-dd HH:mm")} (ISO: ${utc.toISO()})
üß≠ –¢–∞–π–º–∑–æ–Ω–∞: ${zone}
      `.trim();

      document.getElementById("result").textContent = resultText;

      if (window.Telegram && Telegram.WebApp) {
        Telegram.WebApp.sendData(JSON.stringify({
          datetime_iso: utc.toISO(),
          timezone: zone,
          local: local.toFormat("yyyy-MM-dd HH:mm ZZZZ")
        }));
      }
    });

    if (window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.ready();
      Telegram.WebApp.expand();
    }
  </script>
</body>
</html>
